<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Практика. Применение T-SNE на данных</title>
            <style type="text/css">
        body {
            font-family: verdana, arial, sans-serif;
        }
        b {
            font-size: 125%;
            color: blue;
        }
        i {
            font-size: 110%;
            color: green;
        }
    </style>
</head>
<body>
<div><p>
    На этом занятия мы с вами применим алгоритм TSNE к многомерным данным и посмотрим, как влияет гиперпараметр
    перплексии на полученный результат. Данные, которые я буду использовать, это данные с изображениями цифр, которые по
    умолчанию уже забиты в sklearn. Для того чтобы их загрузить, я использую метод load.digits. Чтобы получить
    изображение, я обращусь к атрибуту images результирующей переменной. Посмотрим, что там лежит. Там лежит многомерный
    массив, количество изображений 8 x 8. То есть у нас будет много изображений размера 8 x 8 пикселей. Давайте на
    какое-нибудь из них посмотрим, например, на самое первое. Я буду использовать метод imshow из matplotlib. И для
    красоты я использую серую цветовую схему, чтобы все было не так пестро. Вот. Первое изображение у нас соответствует
    как раз цифре ноль. Теперь, для того чтобы подать эти данные на вход алгоритма, нужно представить их в привычном нам
    виде, то есть в виде матриц объект-признак. В данном случае каждым признаком здесь будет значение интенсивности в
    каждом пикселе. Для этого я многомерность изображений переформатирую с помощью метода reshape со значениями
    атрибутов −1 и 64. 64 потому что у нас 8 * 8 = 64, а −1 это я ему говорю, запихни-ка мне всю остальную размерность,
    все остальные значения возможные, в первую размерность. Таким образом, у нас получилась матричка размера количества
    объектов на 64. А теперь уже можно отправлять ее в алгоритм TSNE. Как обычно, создаем экземпляр класса, количество
    компонент, равное 2, и перплексию давайте поставим по умолчанию 30. Опять сделаем fit, наш любимый. [БЕЗ_ЗВУКА] И
    здесь придется подождать, потому что алгоритм недолгий, по умолчанию в нем тысяча итераций. Алгоритм досчитался, а
    теперь давайте посмотрим на представление объекта в сжатом признаковом пространстве. Для этого я обращусь к атрибуту
    embedding. Результат у нас имеет размерность количество объектов на два, так как мы заказывали размерность сжатую,
    2. И все это дело можно изобразить с помощью метода scatter. Сначала мы подаем первый столбец, второй столбец.
    Получили какие-то кластеры точек. Для того чтобы понять, какие точки к каким цифрам относятся, я достану из исходной
    структуры digits собственно метки этих точек, к каким цифрам они относятся. И подам их на вход в scatter в параметр
    c, то есть цвет. Вот мы видим, что объекты, которые относятся к одним и тем же цифрам, они и в сжатом признаковом
    пространстве находятся близко друг к другу. Ну а теперь давайте посмотрим, на что влияет гиперпараметр перплексии.
    Для этого я заранее уже написал цикл, который проходит по некоторым возможным значениям этого гиперпараметра:
    1, 3, 5, 10, 30 и 50. Ну и далее, в цикле, мы создаем новый экземпляр класса TSNE, обучаем его на данных с этими
    гиперпараметрами, получаем сжатое представление, как мы уже умеем, и просто рисуем для каждого значения перплексии
    результат. Ну и что мы наблюдаем? Что для каких-то небольших значений гиперпараметра перплексии мы наблюдаем очень
    много небольших кластеров. В то время как, если значение перплексии стоит достаточно большое, 10, 30, 50, мы видим,
    что количество кластеров резко падает, но при этом они становятся сами по себе очень большими. Таким образом,
    перплексия регулирует то, на что именно TSNE обращает внимание: на локальную структуру или на глобальную структуру.
    С увеличением перплексии фокус на глобальную структуру данных становится больше, а с уменьшением, наоборот, меньше.
    Именно поэтому у нас и получается много таких небольших кластеров при маленькой перплексии и мало больших кластеров
    при большом значении перплексии.
</p></div>
</body>
</html>